[mbornholdt@submit-1 train]$ cat out_14255338
start training on 14255338
import tensorflow as tf

from deepprofiler.learning.model import DeepProfilerModel
from deepprofiler.imaging.augmentations import AugmentationLayer

tf.compat.v1.disable_v2_behavior()


class ModelClass(DeepProfilerModel):
    def __init__(self, config, dset, generator, val_generator, is_training):
        lshift = self.is_training  # Shift one layer to accommodate the AugmentationLayer

        # => Transfer all weights except conv1.1
        total_layers = len(base_model.layers)
        for i in range(5, total_layers):
            if len(base_model.layers[i].weights) > 0:
                print("Setting pre-trained weights: {:.2f}%".format((i / total_layers) * 100), end="\r")
                self.feature_model.layers[i + lshift].set_weights(base_model.layers[i].get_weights())

        print("Network initialized with pretrained ImageNet weights")
-------------
{
    "dataset": {
        "metadata": {
            "label_field": "Compound",
            "control_value": "DMSO"
        },
        "images": {
            "channels": [
                "DNA",
                "RNA",
                "ER",
                "AGP",
                "Mito"
              ],
            "file_format": "png",
            "bits": 8,
            "width": 1080,
            "height": 1080
        },
        "locations":{
            "mode": "single_cells",
            "box_size": 128,
            "area_coverage": 0.75,
            "mask_objects": false
        }
    },
    "prepare": {
        "illumination_correction": {
            "down_scale_factor": 4,
            "median_filter_size": 24
        },
        "compression": {
            "implement": false,
            "scaling_factor": 1.0
        }
    },
    "train": {
        "partition": {
            "targets": [
                "Compound"
            ],
            "split_field": "Split",
            "training_values": ["Training"],
            "validation_values": ["Test"]
        },
        "model": {
            "name": "efficientnet",
            "crop_generator": "sampled_crop_generator",
            "metrics": ["accuracy", "top_k"],
            "epochs": 10,
            "initialization":"ImageNet",
            "params": {
                "learning_rate": 0.005,
                "batch_size": 64,
                "conv_blocks": 0,
                "feature_dim": 256,
                "pooling": "avg"
            },
            "lr_schedule": "cosine"
        },
        "sampling": {
            "factor": 1,
            "workers": 4,
            "cache_size": 10000
        },
        "validation": {
            "frequency": 1,
            "top_k": 10,
            "batch_size": 64,
            "frame": "val",
            "sample_first_crops": true
        }
    },
    "profile": {
      "use_pretrained_input_size": 224,
      "feature_layer": "avg_pool",
      "checkpoint": "efficientnetb0_notop.h5",
      "batch_size": 8
    }
}

-------------
Matplotlib created a temporary config/cache directory at /var/lib/condor/execute/slot1/dir_54340/matplotlib-kw538y3q because the default path (/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
2021-08-06 21:08:50.964783: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-08-06 21:08:51,942 - WARNING - From /usr/local/lib/python3.6/dist-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
Reading metadata form /local_group_storage/broad_data/michael/training/inputs/metadata/top20_moa.csv
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 24976 entries, 0 to 24975
Data columns (total 21 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   Unnamed: 0                 24976 non-null  int64  
 1   Metadata_Plate             24976 non-null  object 
 2   Metadata_Well              24976 non-null  object 
 3   Metadata_Site              24976 non-null  int64  
 4   Metadata_broad_sample      24976 non-null  object 
 5   Metadata_moa               24976 non-null  object 
 6   Metadata_mmoles_per_liter  24976 non-null  float64
 7   Metadata_dose_recode       24976 non-null  int64  
 8   RNA                        24976 non-null  object 
 9   ER                         24976 non-null  object 
 10  AGP                        24976 non-null  object 
 11  Mito                       24976 non-null  object 
 12  DNA                        24976 non-null  object 
 13  Concentration              24976 non-null  object 
 14  Treatment_ID               24976 non-null  int64  
 15  Compound                   24976 non-null  object 
 16  pert_iname                 24976 non-null  object 
 17  Treatment_Replicate        24976 non-null  int64  
 18  Treatment                  24976 non-null  object 
 19  Plate_Map_Name             24976 non-null  object 
 20  Split                      24976 non-null  object 
dtypes: float64(1), int64(5), object(15)
memory usage: 4.0+ MB
None
{'BRD-A00218260-001-03-4': 0, 'BRD-A00546892-001-02-6': 1, 'BRD-A01636364-003-15-1': 2, 'BRD-A01787639-003-16-9': 3, 'BRD-A02006392-001-10-7': 4, 'BRD-A02990301-003-06-6': 5, 'BRD-A03061970-003-07-3': 6, 'BRD-A03506276-001-01-5': 7, 'BRD-A03623303-045-09-5': 8, 'BRD-A04352665-001-05-3': 9, 'BRD-A04553218-050-16-2': 10, 'BRD-A05821830-341-01-5': 11, 'BRD-A07395371-003-10-0': 12, 'BRD-A07440155-003-25-4': 13, 'BRD-A07563059-035-01-3': 14, 'BRD-A07704283-001-01-3': 15, 'BRD-A09349126-001-10-7': 16, 'BRD-A09472452-015-23-4': 17, 'BRD-A09533288-003-31-2': 18, 'BRD-A10039652-001-01-2': 19, 'BRD-A10070317-003-28-3': 20, 'BRD-A10903566-003-07-7': 21, 'BRD-A10967948-003-06-3': 22, 'BRD-A10977446-001-12-1': 23, 'BRD-A11319535-001-03-6': 24, 'BRD-A12077521-003-01-5': 25, 'BRD-A12896037-001-04-3': 26, 'BRD-A13133631-001-04-0': 27, 'BRD-A13188892-066-21-5': 28, 'BRD-A14798026-001-02-6': 29, 'BRD-A14966924-003-07-7': 30, 'BRD-A15297126-001-04-3': 31, 'BRD-A16665823-001-02-0': 32, 'BRD-A17411484-001-11-9': 33, 'BRD-A17462676-003-11-6': 34, 'BRD-A17655518-001-24-4': 35, 'BRD-A18620900-001-05-2': 36, 'BRD-A18917088-001-04-9': 37, 'BRD-A19661776-003-27-6': 38, 'BRD-A19736161-001-06-7': 39, 'BRD-A20119038-003-07-8': 40, 'BRD-A20126139-001-04-2': 41, 'BRD-A20239487-001-24-9': 42, 'BRD-A21607826-003-05-1': 43, 'BRD-A22032524-074-06-5': 44, 'BRD-A24228527-213-01-9': 45, 'BRD-A26095496-001-04-0': 46, 'BRD-A26423207-001-01-0': 47, 'BRD-A26690767-066-01-9': 48, 'BRD-A26711594-003-10-6': 49, 'BRD-A28467416-002-01-0': 50, 'BRD-A28746609-001-11-5': 51, 'BRD-A29260609-003-26-0': 52, 'BRD-A29485665-001-12-8': 53, 'BRD-A29731977-001-04-5': 54, 'BRD-A29734509-011-13-6': 55, 'BRD-A29844814-300-01-5': 56, 'BRD-A30815329-001-10-5': 57, 'BRD-A32172948-001-07-6': 58, 'BRD-A33084557-001-06-6': 59, 'BRD-A33168282-003-18-0': 60, 'BRD-A33280134-001-04-7': 61, 'BRD-A33692381-001-01-9': 62, 'BRD-A33697453-008-02-4': 63, 'BRD-A33711280-003-03-1': 64, 'BRD-A34006693-001-15-4': 65, 'BRD-A34255068-001-34-5': 66, 'BRD-A36010170-001-04-0': 67, 'BRD-A37780065-001-04-5': 68, 'BRD-A38350138-001-04-9': 69, 'BRD-A39415247-001-10-4': 70, 'BRD-A39935389-001-05-9': 71, 'BRD-A40084411-003-07-7': 72, 'BRD-A40639672-234-18-0': 73, 'BRD-A40787240-066-04-6': 74, 'BRD-A46179541-311-02-0': 75, 'BRD-A49765801-001-04-1': 76, 'BRD-A50684349-003-02-9': 77, 'BRD-A50764878-003-02-8': 78, 'BRD-A51382177-236-03-0': 79, 'BRD-A53176877-001-04-3': 80, 'BRD-A53576514-048-14-3': 81, 'BRD-A55272860-001-15-3': 82, 'BRD-A55579717-001-04-0': 83, 'BRD-A58048407-001-18-8': 84, 'BRD-A59174698-003-18-5': 85, 'BRD-A61221616-001-04-3': 86, 'BRD-A62035778-004-03-6': 87, 'BRD-A62071884-001-04-6': 88, 'BRD-A62525898-001-05-2': 89, 'BRD-A65013509-003-24-4': 90, 'BRD-A65248799-001-01-7': 91, 'BRD-A65280694-003-13-7': 92, 'BRD-A67479912-001-03-4': 93, 'BRD-A67516570-001-02-8': 94, 'BRD-A67616246-001-07-9': 95, 'BRD-A67862938-034-14-9': 96, 'BRD-A68493689-001-01-9': 97, 'BRD-A68888262-003-15-1': 98, 'BRD-A69275535-001-01-5': 99, 'BRD-A69636825-003-04-7': 100, 'BRD-A73368467-003-17-6': 101, 'BRD-A74391928-051-01-3': 102, 'BRD-A74667430-001-23-6': 103, 'BRD-A74980173-001-11-9': 104, 'BRD-A75172220-001-04-0': 105, 'BRD-A75726477-003-21-3': 106, 'BRD-A78723049-001-01-2': 107, 'BRD-A78877355-001-03-0': 108, 'BRD-A79768653-001-12-0': 109, 'BRD-A79981887-003-16-4': 110, 'BRD-A80151636-066-04-8': 111, 'BRD-A81233518-004-16-1': 112, 'BRD-A82396632-008-29-0': 113, 'BRD-A84481105-003-20-6': 114, 'BRD-A85548292-001-01-8': 115, 'BRD-A86216746-046-02-6': 116, 'BRD-A87479750-001-02-7': 117, 'BRD-A88138582-001-04-8': 118, 'BRD-A89175223-051-14-8': 119, 'BRD-A90799790-001-19-9': 120, 'BRD-A92826379-001-01-5': 121, 'BRD-A93424738-001-04-8': 122, 'BRD-A93964801-003-03-3': 123, 'BRD-A94276798-001-01-4': 124, 'BRD-A94543220-001-24-7': 125, 'BRD-A95032015-065-01-2': 126, 'BRD-A95939040-001-01-2': 127, 'BRD-A96060515-004-01-6': 128, 'BRD-A97104540-004-15-0': 129, 'BRD-A97479839-003-13-3': 130, 'BRD-A97674275-001-11-8': 131, 'BRD-A97701745-001-16-0': 132, 'BRD-A97739905-001-26-5': 133, 'BRD-A98990573-003-01-3': 134, 'BRD-K00152668-001-01-5': 135, 'BRD-K00494077-066-01-9': 136, 'BRD-K00610438-003-02-5': 137, 'BRD-K00673382-001-18-9': 138, 'BRD-K01292756-001-25-0': 139, 'BRD-K01663662-003-20-2': 140, 'BRD-K02079473-001-01-3': 141, 'BRD-K02292852-001-02-1': 142, 'BRD-K02389548-001-02-5': 143, 'BRD-K02637541-001-18-0': 144, 'BRD-K02943813-001-01-9': 145, 'BRD-K02950022-001-02-9': 146, 'BRD-K02992638-001-11-8': 147, 'BRD-K03194791-001-04-8': 148, 'BRD-K03390685-001-01-7': 149, 'BRD-K04111260-001-10-0': 150, 'BRD-K04112579-001-07-0': 151, 'BRD-K04264130-001-01-4': 152, 'BRD-K04704168-003-14-3': 153, 'BRD-K04804440-001-09-5': 154, 'BRD-K04956647-003-02-5': 155, 'BRD-K05104363-001-10-0': 156, 'BRD-K05395900-322-05-4': 157, 'BRD-K05446112-001-01-8': 158, 'BRD-K05524748-003-04-4': 159, 'BRD-K05673000-236-12-1': 160, 'BRD-K05674516-001-02-5': 161, 'BRD-K05977355-001-19-0': 162, 'BRD-K06335600-003-20-7': 163, 'BRD-K06388322-312-02-6': 164, 'BRD-K06762493-001-08-1': 165, 'BRD-K06900071-001-01-2': 166, 'BRD-K07220430-001-18-4': 167, 'BRD-K07310275-001-02-5': 168, 'BRD-K07691486-001-15-5': 169, 'BRD-K07798980-001-01-9': 170, 'BRD-K08252256-236-33-8': 171, 'BRD-K08547377-394-03-5': 172, 'BRD-K08799216-001-05-3': 173, 'BRD-K08924299-003-06-1': 174, 'BRD-K09078998-001-01-4': 175, 'BRD-K09397065-003-06-1': 176, 'BRD-K09426783-300-01-0': 177, 'BRD-K09471561-001-18-2': 178, 'BRD-K10670311-001-15-5': 179, 'BRD-K11071038-001-01-7': 180, 'BRD-K11196887-001-21-2': 181, 'BRD-K11433652-001-17-0': 182, 'BRD-K12184916-001-15-4': 183, 'BRD-K12423485-001-01-7': 184, 'BRD-K12539416-001-01-4': 185, 'BRD-K12787259-001-04-3': 186, 'BRD-K12867552-001-04-7': 187, 'BRD-K12932420-001-02-3': 188, 'BRD-K12994359-001-18-4': 189, 'BRD-K13154216-001-01-3': 190, 'BRD-K13390322-001-06-3': 191, 'BRD-K13662825-001-07-5': 192, 'BRD-K13926615-003-03-3': 193, 'BRD-K14175878-001-01-6': 194, 'BRD-K14704277-001-22-6': 195, 'BRD-K15010214-364-02-7': 196, 'BRD-K15567136-003-27-2': 197, 'BRD-K15766189-001-09-8': 198, 'BRD-K15933101-003-06-1': 199, 'BRD-K16077845-001-06-1': 200, 'BRD-K16195444-003-26-0': 201, 'BRD-K16542329-001-13-5': 202, 'BRD-K16757695-050-02-5': 203, 'BRD-K16803204-001-01-6': 204, 'BRD-K17026858-001-01-2': 205, 'BRD-K17068645-003-04-2': 206, 'BRD-K17498618-344-02-6': 207, 'BRD-K17555800-003-01-5': 208, 'BRD-K17561142-003-32-5': 209, 'BRD-K17743125-001-08-4': 210, 'BRD-K18194590-065-08-0': 211, 'BRD-K18324993-001-01-6': 212, 'BRD-K18850819-001-04-6': 213, 'BRD-K18895904-001-16-1': 214, 'BRD-K19352500-070-12-4': 215, 'BRD-K19412355-001-01-0': 216, 'BRD-K19438463-001-05-5': 217, 'BRD-K19456237-001-27-6': 218, 'BRD-K19687926-379-07-4': 219, 'BRD-K19741547-003-01-7': 220, 'BRD-K20745393-003-01-0': 221, 'BRD-K21548250-003-19-1': 222, 'BRD-K21680192-300-14-4': 223, 'BRD-K21884483-001-03-7': 224, 'BRD-K22024824-001-03-7': 225, 'BRD-K22134346-001-22-3': 226, 'BRD-K22482860-001-21-4': 227, 'BRD-K22749967-046-02-3': 228, 'BRD-K23082237-003-01-5': 229, 'BRD-K23204545-001-16-4': 230, 'BRD-K23228615-001-02-8': 231, 'BRD-K23363278-001-02-1': 232, 'BRD-K23499943-003-01-6': 233, 'BRD-K23677682-003-01-2': 234, 'BRD-K24219278-001-01-6': 235, 'BRD-K24616672-003-20-1': 236, 'BRD-K24723746-036-02-5': 237, 'BRD-K24943235-001-01-3': 238, 'BRD-K25394294-001-14-9': 239, 'BRD-K25412176-001-01-9': 240, 'BRD-K25630527-001-03-8': 241, 'BRD-K25943794-001-02-3': 242, 'BRD-K26011976-001-01-0': 243, 'BRD-K26603252-003-04-9': 244, 'BRD-K26667523-001-02-5': 245, 'BRD-K27184429-300-01-3': 246, 'BRD-K28143534-003-25-9': 247, 'BRD-K28307902-001-21-7': 248, 'BRD-K28456624-001-01-1': 249, 'BRD-K28731095-001-01-7': 250, 'BRD-K28822270-001-01-1': 251, 'BRD-K28971625-003-01-4': 252, 'BRD-K29458283-001-29-9': 253, 'BRD-K29582115-066-01-2': 254, 'BRD-K30126819-304-02-7': 255, 'BRD-K30421593-050-04-9': 256, 'BRD-K31092604-003-03-5': 257, 'BRD-K31339321-001-03-6': 258, 'BRD-K31447894-236-01-0': 259, 'BRD-K31519811-001-02-2': 260, 'BRD-K31627533-001-09-5': 261, 'BRD-K31812033-003-11-0': 262, 'BRD-K31928526-001-02-1': 263, 'BRD-K32977963-001-05-0': 264, 'BRD-K33127281-001-05-6': 265, 'BRD-K33226500-001-01-0': 266, 'BRD-K33453211-003-11-5': 267, 'BRD-K33610132-001-02-9': 268, 'BRD-K33852358-001-09-9': 269, 'BRD-K34008116-001-01-7': 270, 'BRD-K34157611-001-16-0': 271, 'BRD-K34313798-001-01-6': 272, 'BRD-K34328244-001-01-4': 273, 'BRD-K34415467-003-13-0': 274, 'BRD-K34469523-003-03-0': 275, 'BRD-K34888156-213-01-4': 276, 'BRD-K35007173-001-07-5': 277, 'BRD-K35245662-001-01-2': 278, 'BRD-K35586044-003-15-4': 279, 'BRD-K35719256-001-02-6': 280, 'BRD-K36280065-048-01-2': 281, 'BRD-K36627727-001-05-4': 282, 'BRD-K36732695-001-01-9': 283, 'BRD-K36740062-001-06-6': 284, 'BRD-K37289225-001-36-4': 285, 'BRD-K37561857-001-15-5': 286, 'BRD-K37590257-001-02-8': 287, 'BRD-K37687095-001-06-9': 288, 'BRD-K37694030-003-12-7': 289, 'BRD-K37714784-305-02-1': 290, 'BRD-K37890730-001-15-1': 291, 'BRD-K38287497-001-01-2': 292, 'BRD-K38473998-001-02-0': 293, 'BRD-K38852836-001-02-1': 294, 'BRD-K39252998-003-01-5': 295, 'BRD-K39339537-001-21-0': 296, 'BRD-K40175214-001-11-6': 297, 'BRD-K40227168-001-12-9': 298, 'BRD-K40758068-001-08-2': 299, 'BRD-K41160163-001-06-8': 300, 'BRD-K41213548-001-02-0': 301, 'BRD-K41410256-304-02-2': 302, 'BRD-K41434598-003-01-9': 303, 'BRD-K41524689-001-23-5': 304, 'BRD-K42191735-001-05-3': 305, 'BRD-K42805893-001-04-9': 306, 'BRD-K42898655-001-01-8': 307, 'BRD-K42948882-305-01-1': 308, 'BRD-K43002771-034-01-6': 309, 'BRD-K43586850-001-02-9': 310, 'BRD-K43887077-003-26-3': 311, 'BRD-K43966364-237-04-8': 312, 'BRD-K44844162-001-01-6': 313, 'BRD-K45152786-001-08-4': 314, 'BRD-K45158365-001-11-4': 315, 'BRD-K45330754-001-21-7': 316, 'BRD-K45924332-001-16-8': 317, 'BRD-K46386702-001-02-1': 318, 'BRD-K46654563-238-01-0': 319, 'BRD-K46692793-004-01-8': 320, 'BRD-K46937689-001-15-0': 321, 'BRD-K46970505-003-01-9': 322, 'BRD-K47639036-003-06-6': 323, 'BRD-K47642186-001-01-3': 324, 'BRD-K47936004-003-11-4': 325, 'BRD-K47976015-001-01-2': 326, 'BRD-K48195801-001-01-6': 327, 'BRD-K48461310-234-01-3': 328, 'BRD-K48578705-001-16-8': 329, 'BRD-K49111258-003-29-7': 330, 'BRD-K49215523-001-04-2': 331, 'BRD-K49404994-001-10-9': 332, 'BRD-K49456274-001-01-9': 333, 'BRD-K49671696-045-08-5': 334, 'BRD-K49685476-001-15-9': 335, 'BRD-K49807096-003-15-5': 336, 'BRD-K49865102-001-08-4': 337, 'BRD-K50031829-001-01-6': 338, 'BRD-K50163129-001-01-4': 339, 'BRD-K50168500-001-07-9': 340, 'BRD-K50938287-036-13-8': 341, 'BRD-K51143828-003-03-1': 342, 'BRD-K51313569-003-03-3': 343, 'BRD-K51324732-001-01-0': 344, 'BRD-K51485625-001-08-4': 345, 'BRD-K51967704-001-03-6': 346, 'BRD-K52020312-001-26-8': 347, 'BRD-K52233191-001-02-4': 348, 'BRD-K52313696-001-12-3': 349, 'BRD-K52751261-001-06-1': 350, 'BRD-K52911425-001-09-8': 351, 'BRD-K53581288-001-02-9': 352, 'BRD-K53665955-001-03-0': 353, 'BRD-K53857191-001-22-7': 354, 'BRD-K53972329-001-07-0': 355, 'BRD-K54006094-051-01-7': 356, 'BRD-K54770957-001-04-3': 357, 'BRD-K54847683-001-03-2': 358, 'BRD-K55127134-300-11-2': 359, 'BRD-K56104152-008-04-1': 360, 'BRD-K56195681-001-01-0': 361, 'BRD-K56291712-001-01-0': 362, 'BRD-K56334280-001-05-1': 363, 'BRD-K56558538-003-11-9': 364, 'BRD-K56800335-015-04-9': 365, 'BRD-K56844688-003-01-2': 366, 'BRD-K56851771-001-06-8': 367, 'BRD-K56957086-001-06-3': 368, 'BRD-K57080016-001-15-9': 369, 'BRD-K57169635-001-04-5': 370, 'BRD-K57222227-001-30-1': 371, 'BRD-K57371763-001-01-7': 372, 'BRD-K57432881-003-21-8': 373, 'BRD-K57545991-050-23-1': 374, 'BRD-K57569181-001-27-5': 375, 'BRD-K57764956-001-02-8': 376, 'BRD-K58435339-001-03-0': 377, 'BRD-K58486055-001-02-7': 378, 'BRD-K58951486-004-01-5': 379, 'BRD-K59058766-003-21-9': 380, 'BRD-K59197931-001-04-5': 381, 'BRD-K59227464-334-02-4': 382, 'BRD-K59317601-001-05-5': 383, 'BRD-K59332007-300-02-7': 384, 'BRD-K59573506-001-01-8': 385, 'BRD-K59632282-052-03-1': 386, 'BRD-K60038276-001-09-0': 387, 'BRD-K60585088-001-01-5': 388, 'BRD-K60866521-001-07-1': 389, 'BRD-K61195623-001-01-4': 390, 'BRD-K61397605-001-03-4': 391, 'BRD-K61452026-001-04-6': 392, 'BRD-K61691541-001-01-1': 393, 'BRD-K62200014-003-10-5': 394, 'BRD-K62310379-001-10-5': 395, 'BRD-K62387885-001-01-9': 396, 'BRD-K62398570-300-01-2': 397, 'BRD-K62737565-003-02-6': 398, 'BRD-K62762455-001-01-3': 399, 'BRD-K62858456-001-01-8': 400, 'BRD-K62996583-001-10-3': 401, 'BRD-K63675182-003-23-6': 402, 'BRD-K64052750-001-17-5': 403, 'BRD-K64504314-001-01-8': 404, 'BRD-K64538373-001-01-4': 405, 'BRD-K64755930-003-03-2': 406, 'BRD-K64785675-001-04-0': 407, 'BRD-K64800655-001-07-4': 408, 'BRD-K65428967-001-08-4': 409, 'BRD-K65781196-001-03-0': 410, 'BRD-K65928735-001-04-3': 411, 'BRD-K66175015-001-09-0': 412, 'BRD-K66412701-066-01-6': 413, 'BRD-K66615216-003-14-8': 414, 'BRD-K66937583-001-01-2': 415, 'BRD-K67017579-001-28-1': 416, 'BRD-K67068943-001-01-0': 417, 'BRD-K67080878-001-15-4': 418, 'BRD-K67102207-236-07-7': 419, 'BRD-K67783091-001-26-1': 420, 'BRD-K67868012-001-07-6': 421, 'BRD-K67966701-001-11-6': 422, 'BRD-K68065987-300-09-1': 423, 'BRD-K68346641-001-02-2': 424, 'BRD-K68693535-001-03-4': 425, 'BRD-K68747584-001-02-0': 426, 'BRD-K68867920-051-11-5': 427, 'BRD-K69116396-001-04-1': 428, 'BRD-K69247067-001-01-8': 429, 'BRD-K69726342-238-02-4': 430, 'BRD-K69726595-001-01-2': 431, 'BRD-K70330367-003-07-9': 432, 'BRD-K70401845-003-09-6': 433, 'BRD-K70610771-001-02-9': 434, 'BRD-K70792160-003-04-6': 435, 'BRD-K70912147-001-01-8': 436, 'BRD-K70914287-300-02-8': 437, 'BRD-K70924353-001-01-2': 438, 'BRD-K71058253-001-01-9': 439, 'BRD-K71281111-001-04-3': 440, 'BRD-K71480163-001-01-4': 441, 'BRD-K71603915-003-01-8': 442, 'BRD-K72166146-066-05-4': 443, 'BRD-K72222507-003-16-8': 444, 'BRD-K72414522-001-06-7': 445, 'BRD-K73107279-003-12-5': 446, 'BRD-K73196317-003-14-8': 447, 'BRD-K73237276-001-01-0': 448, 'BRD-K73381542-003-23-4': 449, 'BRD-K73541271-001-03-6': 450, 'BRD-K73999723-001-11-3': 451, 'BRD-K74057757-001-01-9': 452, 'BRD-K74065929-001-07-2': 453, 'BRD-K74190368-001-04-3': 454, 'BRD-K74195153-050-12-1': 455, 'BRD-K74339692-001-01-9': 456, 'BRD-K74363950-004-01-0': 457, 'BRD-K75089421-003-24-5': 458, 'BRD-K75295174-001-05-0': 459, 'BRD-K75641298-003-25-0': 460, 'BRD-K75699339-057-08-1': 461, 'BRD-K75844781-003-08-0': 462, 'BRD-K75958547-238-01-0': 463, 'BRD-K76022557-003-02-7': 464, 'BRD-K76205745-237-16-5': 465, 'BRD-K76775527-001-30-2': 466, 'BRD-K76810206-001-07-3': 467, 'BRD-K76841105-001-04-7': 468, 'BRD-K76953762-001-08-5': 469, 'BRD-K77641333-003-27-1': 470, 'BRD-K77908580-001-09-6': 471, 'BRD-K77947974-001-16-3': 472, 'BRD-K77987382-001-13-2': 473, 'BRD-K78096648-001-05-7': 474, 'BRD-K78113049-001-16-2': 475, 'BRD-K78485176-001-07-8': 476, 'BRD-K78567475-001-01-4': 477, 'BRD-K79102359-003-01-6': 478, 'BRD-K79131256-001-17-9': 479, 'BRD-K79595931-312-01-3': 480, 'BRD-K79759585-048-04-8': 481, 'BRD-K79989959-001-01-4': 482, 'BRD-K80267133-001-17-7': 483, 'BRD-K80343549-001-02-6': 484, 'BRD-K80608265-001-01-6': 485, 'BRD-K81144366-003-19-7': 486, 'BRD-K81258678-001-01-0': 487, 'BRD-K81272440-236-13-5': 488, 'BRD-K81332461-001-01-4': 489, 'BRD-K81957469-001-01-0': 490, 'BRD-K82244583-001-01-3': 491, 'BRD-K82467063-001-02-7': 492, 'BRD-K82795137-001-26-2': 493, 'BRD-K82928847-001-04-7': 494, 'BRD-K82941592-238-04-5': 495, 'BRD-K82967685-300-01-2': 496, 'BRD-K83720053-001-03-8': 497, 'BRD-K83794243-001-01-8': 498, 'BRD-K83837640-001-04-8': 499, 'BRD-K83963101-001-06-9': 500, 'BRD-K84091759-001-07-1': 501, 'BRD-K84163249-001-01-9': 502, 'BRD-K84748119-050-01-1': 503, 'BRD-K84794093-001-07-5': 504, 'BRD-K84986517-001-01-8': 505, 'BRD-K85090592-008-22-7': 506, 'BRD-K85307935-236-09-5': 507, 'BRD-K85337334-004-02-6': 508, 'BRD-K85606544-001-09-1': 509, 'BRD-K85751432-001-03-3': 510, 'BRD-K85925969-001-17-4': 511, 'BRD-K86301799-001-34-8': 512, 'BRD-K86797399-001-04-4': 513, 'BRD-K86882815-001-03-2': 514, 'BRD-K87737963-001-06-0': 515, 'BRD-K87909389-003-03-4': 516, 'BRD-K87990216-001-10-2': 517, 'BRD-K88358234-003-04-8': 518, 'BRD-K89014967-001-04-3': 519, 'BRD-K89208535-051-01-5': 520, 'BRD-K89348303-001-14-7': 521, 'BRD-K89375097-300-08-8': 522, 'BRD-K89561498-001-01-7': 523, 'BRD-K89704198-001-12-3': 524, 'BRD-K89732114-300-08-9': 525, 'BRD-K89997465-003-43-0': 526, 'BRD-K90239174-001-01-8': 527, 'BRD-K90333595-003-21-4': 528, 'BRD-K90825648-001-02-0': 529, 'BRD-K91111634-001-01-2': 530, 'BRD-K91308639-001-02-7': 531, 'BRD-K91336023-003-01-0': 532, 'BRD-K91740057-001-19-8': 533, 'BRD-K91825936-001-01-2': 534, 'BRD-K92049597-001-20-8': 535, 'BRD-K92093830-003-30-8': 536, 'BRD-K92303087-001-01-6': 537, 'BRD-K92441787-001-04-1': 538, 'BRD-K92731339-227-04-9': 539, 'BRD-K92968657-001-01-6': 540, 'BRD-K92984783-003-05-7': 541, 'BRD-K93208532-001-02-5': 542, 'BRD-K93461745-003-25-0': 543, 'BRD-K93645900-001-11-3': 544, 'BRD-K94420399-001-01-9': 545, 'BRD-K95260951-050-03-1': 546, 'BRD-K95773607-004-03-8': 547, 'BRD-K95880107-001-02-4': 548, 'BRD-K95901403-001-04-5': 549, 'BRD-K96042922-001-09-8': 550, 'BRD-K96740444-001-02-1': 551, 'BRD-K97158071-001-18-1': 552, 'BRD-K97181089-003-24-7': 553, 'BRD-K97309399-001-09-4': 554, 'BRD-K97564742-050-32-7': 555, 'BRD-K97688263-001-03-7': 556, 'BRD-K98453471-001-01-7': 557, 'BRD-K98493452-001-14-9': 558, 'BRD-K98530306-003-18-3': 559, 'BRD-K98572433-001-02-9': 560, 'BRD-K98624455-074-02-8': 561, 'BRD-K99023089-001-03-7': 562, 'BRD-K99107520-001-24-1': 563, 'BRD-K99113996-001-02-0': 564, 'BRD-K99257182-310-01-6': 565, 'BRD-K99451608-001-07-3': 566, 'BRD-K99475619-001-01-2': 567, 'BRD-K99604664-001-01-1': 568, 'DMSO': 569}
Reading single-cell locations
2021-08-06 21:09:40,683 - WARNING - From /usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/layers/normalization.py:534: _colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2021-08-06 21:09:42,659 - WARNING - From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/init_ops.py:97: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2021-08-06 21:09:42,660 - WARNING - From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/init_ops.py:97: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2021-08-06 21:09:42,661 - WARNING - From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/init_ops.py:97: calling Ones.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2021-08-06 21:09:42,877 - WARNING - From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/init_ops.py:97: calling GlorotUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 128, 128, 5) 0                                            
__________________________________________________________________________________________________
augmentation_layer (Augmentatio (None, 128, 128, 5)  0           input_1[0][0]                    
__________________________________________________________________________________________________
rescaling (Rescaling)           (None, 128, 128, 5)  0           augmentation_layer[0][0]         
__________________________________________________________________________________________________
normalization (Normalization)   (None, 128, 128, 5)  11          rescaling[0][0]                  
__________________________________________________________________________________________________
stem_conv_pad (ZeroPadding2D)   (None, 129, 129, 5)  0           normalization[0][0]              
__________________________________________________________________________________________________
stem_conv (Conv2D)              (None, 64, 64, 32)   1440        stem_conv_pad[0][0]              
__________________________________________________________________________________________________
stem_bn (BatchNormalization)    (None, 64, 64, 32)   128         stem_conv[0][0]                  
__________________________________________________________________________________________________
stem_activation (Activation)    (None, 64, 64, 32)   0           stem_bn[0][0]                    
__________________________________________________________________________________________________
block1a_dwconv (DepthwiseConv2D (None, 64, 64, 32)   288         stem_activation[0][0]            
__________________________________________________________________________________________________
block1a_bn (BatchNormalization) (None, 64, 64, 32)   128         block1a_dwconv[0][0]             
__________________________________________________________________________________________________
block1a_activation (Activation) (None, 64, 64, 32)   0           block1a_bn[0][0]                 
__________________________________________________________________________________________________
block1a_se_squeeze (GlobalAvera (None, 32)           0           block1a_activation[0][0]         
__________________________________________________________________________________________________
block1a_se_reshape (Reshape)    (None, 1, 1, 32)     0           block1a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block1a_se_reduce (Conv2D)      (None, 1, 1, 8)      264         block1a_se_reshape[0][0]         
__________________________________________________________________________________________________
block1a_se_expand (Conv2D)      (None, 1, 1, 32)     288         block1a_se_reduce[0][0]          
__________________________________________________________________________________________________
block1a_se_excite (Multiply)    (None, 64, 64, 32)   0           block1a_activation[0][0]         
                                                                 block1a_se_expand[0][0]          
__________________________________________________________________________________________________
block1a_project_conv (Conv2D)   (None, 64, 64, 16)   512         block1a_se_excite[0][0]          
__________________________________________________________________________________________________
block1a_project_bn (BatchNormal (None, 64, 64, 16)   64          block1a_project_conv[0][0]       
__________________________________________________________________________________________________
block2a_expand_conv (Conv2D)    (None, 64, 64, 96)   1536        block1a_project_bn[0][0]         
__________________________________________________________________________________________________
block2a_expand_bn (BatchNormali (None, 64, 64, 96)   384         block2a_expand_conv[0][0]        
__________________________________________________________________________________________________
block2a_expand_activation (Acti (None, 64, 64, 96)   0           block2a_expand_bn[0][0]          
__________________________________________________________________________________________________
block2a_dwconv_pad (ZeroPadding (None, 65, 65, 96)   0           block2a_expand_activation[0][0]  
__________________________________________________________________________________________________
block2a_dwconv (DepthwiseConv2D (None, 32, 32, 96)   864         block2a_dwconv_pad[0][0]         
__________________________________________________________________________________________________
block2a_bn (BatchNormalization) (None, 32, 32, 96)   384         block2a_dwconv[0][0]             
__________________________________________________________________________________________________
block2a_activation (Activation) (None, 32, 32, 96)   0           block2a_bn[0][0]                 
__________________________________________________________________________________________________
block2a_se_squeeze (GlobalAvera (None, 96)           0           block2a_activation[0][0]         
__________________________________________________________________________________________________
block2a_se_reshape (Reshape)    (None, 1, 1, 96)     0           block2a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block2a_se_reduce (Conv2D)      (None, 1, 1, 4)      388         block2a_se_reshape[0][0]         
__________________________________________________________________________________________________
block2a_se_expand (Conv2D)      (None, 1, 1, 96)     480         block2a_se_reduce[0][0]          
__________________________________________________________________________________________________
block2a_se_excite (Multiply)    (None, 32, 32, 96)   0           block2a_activation[0][0]         
                                                                 block2a_se_expand[0][0]          
__________________________________________________________________________________________________
block2a_project_conv (Conv2D)   (None, 32, 32, 24)   2304        block2a_se_excite[0][0]          
__________________________________________________________________________________________________
block2a_project_bn (BatchNormal (None, 32, 32, 24)   96          block2a_project_conv[0][0]       
__________________________________________________________________________________________________
block2b_expand_conv (Conv2D)    (None, 32, 32, 144)  3456        block2a_project_bn[0][0]         
__________________________________________________________________________________________________
block2b_expand_bn (BatchNormali (None, 32, 32, 144)  576         block2b_expand_conv[0][0]        
__________________________________________________________________________________________________
block2b_expand_activation (Acti (None, 32, 32, 144)  0           block2b_expand_bn[0][0]          
__________________________________________________________________________________________________
block2b_dwconv (DepthwiseConv2D (None, 32, 32, 144)  1296        block2b_expand_activation[0][0]  
__________________________________________________________________________________________________
block2b_bn (BatchNormalization) (None, 32, 32, 144)  576         block2b_dwconv[0][0]             
__________________________________________________________________________________________________
block2b_activation (Activation) (None, 32, 32, 144)  0           block2b_bn[0][0]                 
__________________________________________________________________________________________________
block2b_se_squeeze (GlobalAvera (None, 144)          0           block2b_activation[0][0]         
__________________________________________________________________________________________________
block2b_se_reshape (Reshape)    (None, 1, 1, 144)    0           block2b_se_squeeze[0][0]         
__________________________________________________________________________________________________
block2b_se_reduce (Conv2D)      (None, 1, 1, 6)      870         block2b_se_reshape[0][0]         
__________________________________________________________________________________________________
block2b_se_expand (Conv2D)      (None, 1, 1, 144)    1008        block2b_se_reduce[0][0]          
__________________________________________________________________________________________________
block2b_se_excite (Multiply)    (None, 32, 32, 144)  0           block2b_activation[0][0]         
                                                                 block2b_se_expand[0][0]          
__________________________________________________________________________________________________
block2b_project_conv (Conv2D)   (None, 32, 32, 24)   3456        block2b_se_excite[0][0]          
__________________________________________________________________________________________________
block2b_project_bn (BatchNormal (None, 32, 32, 24)   96          block2b_project_conv[0][0]       
__________________________________________________________________________________________________
block2b_drop (Dropout)          (None, 32, 32, 24)   0           block2b_project_bn[0][0]         
__________________________________________________________________________________________________
block2b_add (Add)               (None, 32, 32, 24)   0           block2b_drop[0][0]               
                                                                 block2a_project_bn[0][0]         
__________________________________________________________________________________________________
block3a_expand_conv (Conv2D)    (None, 32, 32, 144)  3456        block2b_add[0][0]                
__________________________________________________________________________________________________
block3a_expand_bn (BatchNormali (None, 32, 32, 144)  576         block3a_expand_conv[0][0]        
__________________________________________________________________________________________________
block3a_expand_activation (Acti (None, 32, 32, 144)  0           block3a_expand_bn[0][0]          
__________________________________________________________________________________________________
block3a_dwconv_pad (ZeroPadding (None, 35, 35, 144)  0           block3a_expand_activation[0][0]  
__________________________________________________________________________________________________
block3a_dwconv (DepthwiseConv2D (None, 16, 16, 144)  3600        block3a_dwconv_pad[0][0]         
__________________________________________________________________________________________________
block3a_bn (BatchNormalization) (None, 16, 16, 144)  576         block3a_dwconv[0][0]             
__________________________________________________________________________________________________
block3a_activation (Activation) (None, 16, 16, 144)  0           block3a_bn[0][0]                 
__________________________________________________________________________________________________
block3a_se_squeeze (GlobalAvera (None, 144)          0           block3a_activation[0][0]         
__________________________________________________________________________________________________
block3a_se_reshape (Reshape)    (None, 1, 1, 144)    0           block3a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block3a_se_reduce (Conv2D)      (None, 1, 1, 6)      870         block3a_se_reshape[0][0]         
__________________________________________________________________________________________________
block3a_se_expand (Conv2D)      (None, 1, 1, 144)    1008        block3a_se_reduce[0][0]          
__________________________________________________________________________________________________
block3a_se_excite (Multiply)    (None, 16, 16, 144)  0           block3a_activation[0][0]         
                                                                 block3a_se_expand[0][0]          
__________________________________________________________________________________________________
block3a_project_conv (Conv2D)   (None, 16, 16, 40)   5760        block3a_se_excite[0][0]          
__________________________________________________________________________________________________
block3a_project_bn (BatchNormal (None, 16, 16, 40)   160         block3a_project_conv[0][0]       
__________________________________________________________________________________________________
block3b_expand_conv (Conv2D)    (None, 16, 16, 240)  9600        block3a_project_bn[0][0]         
__________________________________________________________________________________________________
block3b_expand_bn (BatchNormali (None, 16, 16, 240)  960         block3b_expand_conv[0][0]        
__________________________________________________________________________________________________
block3b_expand_activation (Acti (None, 16, 16, 240)  0           block3b_expand_bn[0][0]          
__________________________________________________________________________________________________
block3b_dwconv (DepthwiseConv2D (None, 16, 16, 240)  6000        block3b_expand_activation[0][0]  
__________________________________________________________________________________________________
block3b_bn (BatchNormalization) (None, 16, 16, 240)  960         block3b_dwconv[0][0]             
__________________________________________________________________________________________________
block3b_activation (Activation) (None, 16, 16, 240)  0           block3b_bn[0][0]                 
__________________________________________________________________________________________________
block3b_se_squeeze (GlobalAvera (None, 240)          0           block3b_activation[0][0]         
__________________________________________________________________________________________________
block3b_se_reshape (Reshape)    (None, 1, 1, 240)    0           block3b_se_squeeze[0][0]         
__________________________________________________________________________________________________
block3b_se_reduce (Conv2D)      (None, 1, 1, 10)     2410        block3b_se_reshape[0][0]         
__________________________________________________________________________________________________
block3b_se_expand (Conv2D)      (None, 1, 1, 240)    2640        block3b_se_reduce[0][0]          
__________________________________________________________________________________________________
block3b_se_excite (Multiply)    (None, 16, 16, 240)  0           block3b_activation[0][0]         
                                                                 block3b_se_expand[0][0]          
__________________________________________________________________________________________________
block3b_project_conv (Conv2D)   (None, 16, 16, 40)   9600        block3b_se_excite[0][0]          
__________________________________________________________________________________________________
block3b_project_bn (BatchNormal (None, 16, 16, 40)   160         block3b_project_conv[0][0]       
__________________________________________________________________________________________________
block3b_drop (Dropout)          (None, 16, 16, 40)   0           block3b_project_bn[0][0]         
__________________________________________________________________________________________________
block3b_add (Add)               (None, 16, 16, 40)   0           block3b_drop[0][0]               
                                                                 block3a_project_bn[0][0]         
__________________________________________________________________________________________________
block4a_expand_conv (Conv2D)    (None, 16, 16, 240)  9600        block3b_add[0][0]                
__________________________________________________________________________________________________
block4a_expand_bn (BatchNormali (None, 16, 16, 240)  960         block4a_expand_conv[0][0]        
__________________________________________________________________________________________________
block4a_expand_activation (Acti (None, 16, 16, 240)  0           block4a_expand_bn[0][0]          
__________________________________________________________________________________________________
block4a_dwconv_pad (ZeroPadding (None, 17, 17, 240)  0           block4a_expand_activation[0][0]  
__________________________________________________________________________________________________
block4a_dwconv (DepthwiseConv2D (None, 8, 8, 240)    2160        block4a_dwconv_pad[0][0]         
__________________________________________________________________________________________________
block4a_bn (BatchNormalization) (None, 8, 8, 240)    960         block4a_dwconv[0][0]             
__________________________________________________________________________________________________
block4a_activation (Activation) (None, 8, 8, 240)    0           block4a_bn[0][0]                 
__________________________________________________________________________________________________
block4a_se_squeeze (GlobalAvera (None, 240)          0           block4a_activation[0][0]         
__________________________________________________________________________________________________
block4a_se_reshape (Reshape)    (None, 1, 1, 240)    0           block4a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block4a_se_reduce (Conv2D)      (None, 1, 1, 10)     2410        block4a_se_reshape[0][0]         
__________________________________________________________________________________________________
block4a_se_expand (Conv2D)      (None, 1, 1, 240)    2640        block4a_se_reduce[0][0]          
__________________________________________________________________________________________________
block4a_se_excite (Multiply)    (None, 8, 8, 240)    0           block4a_activation[0][0]         
                                                                 block4a_se_expand[0][0]          
__________________________________________________________________________________________________
block4a_project_conv (Conv2D)   (None, 8, 8, 80)     19200       block4a_se_excite[0][0]          
__________________________________________________________________________________________________
block4a_project_bn (BatchNormal (None, 8, 8, 80)     320         block4a_project_conv[0][0]       
__________________________________________________________________________________________________
block4b_expand_conv (Conv2D)    (None, 8, 8, 480)    38400       block4a_project_bn[0][0]         
__________________________________________________________________________________________________
block4b_expand_bn (BatchNormali (None, 8, 8, 480)    1920        block4b_expand_conv[0][0]        
__________________________________________________________________________________________________
block4b_expand_activation (Acti (None, 8, 8, 480)    0           block4b_expand_bn[0][0]          
__________________________________________________________________________________________________
block4b_dwconv (DepthwiseConv2D (None, 8, 8, 480)    4320        block4b_expand_activation[0][0]  
__________________________________________________________________________________________________
block4b_bn (BatchNormalization) (None, 8, 8, 480)    1920        block4b_dwconv[0][0]             
__________________________________________________________________________________________________
block4b_activation (Activation) (None, 8, 8, 480)    0           block4b_bn[0][0]                 
__________________________________________________________________________________________________
block4b_se_squeeze (GlobalAvera (None, 480)          0           block4b_activation[0][0]         
__________________________________________________________________________________________________
block4b_se_reshape (Reshape)    (None, 1, 1, 480)    0           block4b_se_squeeze[0][0]         
__________________________________________________________________________________________________
block4b_se_reduce (Conv2D)      (None, 1, 1, 20)     9620        block4b_se_reshape[0][0]         
__________________________________________________________________________________________________
block4b_se_expand (Conv2D)      (None, 1, 1, 480)    10080       block4b_se_reduce[0][0]          
__________________________________________________________________________________________________
block4b_se_excite (Multiply)    (None, 8, 8, 480)    0           block4b_activation[0][0]         
                                                                 block4b_se_expand[0][0]          
__________________________________________________________________________________________________
block4b_project_conv (Conv2D)   (None, 8, 8, 80)     38400       block4b_se_excite[0][0]          
__________________________________________________________________________________________________
block4b_project_bn (BatchNormal (None, 8, 8, 80)     320         block4b_project_conv[0][0]       
__________________________________________________________________________________________________
block4b_drop (Dropout)          (None, 8, 8, 80)     0           block4b_project_bn[0][0]         
__________________________________________________________________________________________________
block4b_add (Add)               (None, 8, 8, 80)     0           block4b_drop[0][0]               
                                                                 block4a_project_bn[0][0]         
__________________________________________________________________________________________________
block4c_expand_conv (Conv2D)    (None, 8, 8, 480)    38400       block4b_add[0][0]                
__________________________________________________________________________________________________
block4c_expand_bn (BatchNormali (None, 8, 8, 480)    1920        block4c_expand_conv[0][0]        
__________________________________________________________________________________________________
block4c_expand_activation (Acti (None, 8, 8, 480)    0           block4c_expand_bn[0][0]          
__________________________________________________________________________________________________
block4c_dwconv (DepthwiseConv2D (None, 8, 8, 480)    4320        block4c_expand_activation[0][0]  
__________________________________________________________________________________________________
block4c_bn (BatchNormalization) (None, 8, 8, 480)    1920        block4c_dwconv[0][0]             
__________________________________________________________________________________________________
block4c_activation (Activation) (None, 8, 8, 480)    0           block4c_bn[0][0]                 
__________________________________________________________________________________________________
block4c_se_squeeze (GlobalAvera (None, 480)          0           block4c_activation[0][0]         
__________________________________________________________________________________________________
block4c_se_reshape (Reshape)    (None, 1, 1, 480)    0           block4c_se_squeeze[0][0]         
__________________________________________________________________________________________________
block4c_se_reduce (Conv2D)      (None, 1, 1, 20)     9620        block4c_se_reshape[0][0]         
__________________________________________________________________________________________________
block4c_se_expand (Conv2D)      (None, 1, 1, 480)    10080       block4c_se_reduce[0][0]          
__________________________________________________________________________________________________
block4c_se_excite (Multiply)    (None, 8, 8, 480)    0           block4c_activation[0][0]         
                                                                 block4c_se_expand[0][0]          
__________________________________________________________________________________________________
block4c_project_conv (Conv2D)   (None, 8, 8, 80)     38400       block4c_se_excite[0][0]          
__________________________________________________________________________________________________
block4c_project_bn (BatchNormal (None, 8, 8, 80)     320         block4c_project_conv[0][0]       
__________________________________________________________________________________________________
block4c_drop (Dropout)          (None, 8, 8, 80)     0           block4c_project_bn[0][0]         
__________________________________________________________________________________________________
block4c_add (Add)               (None, 8, 8, 80)     0           block4c_drop[0][0]               
                                                                 block4b_add[0][0]                
__________________________________________________________________________________________________
block5a_expand_conv (Conv2D)    (None, 8, 8, 480)    38400       block4c_add[0][0]                
__________________________________________________________________________________________________
block5a_expand_bn (BatchNormali (None, 8, 8, 480)    1920        block5a_expand_conv[0][0]        
__________________________________________________________________________________________________
block5a_expand_activation (Acti (None, 8, 8, 480)    0           block5a_expand_bn[0][0]          
__________________________________________________________________________________________________
block5a_dwconv (DepthwiseConv2D (None, 8, 8, 480)    12000       block5a_expand_activation[0][0]  
__________________________________________________________________________________________________
block5a_bn (BatchNormalization) (None, 8, 8, 480)    1920        block5a_dwconv[0][0]             
__________________________________________________________________________________________________
block5a_activation (Activation) (None, 8, 8, 480)    0           block5a_bn[0][0]                 
__________________________________________________________________________________________________
block5a_se_squeeze (GlobalAvera (None, 480)          0           block5a_activation[0][0]         
__________________________________________________________________________________________________
block5a_se_reshape (Reshape)    (None, 1, 1, 480)    0           block5a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block5a_se_reduce (Conv2D)      (None, 1, 1, 20)     9620        block5a_se_reshape[0][0]         
__________________________________________________________________________________________________
block5a_se_expand (Conv2D)      (None, 1, 1, 480)    10080       block5a_se_reduce[0][0]          
__________________________________________________________________________________________________
block5a_se_excite (Multiply)    (None, 8, 8, 480)    0           block5a_activation[0][0]         
                                                                 block5a_se_expand[0][0]          
__________________________________________________________________________________________________
block5a_project_conv (Conv2D)   (None, 8, 8, 112)    53760       block5a_se_excite[0][0]          
__________________________________________________________________________________________________
block5a_project_bn (BatchNormal (None, 8, 8, 112)    448         block5a_project_conv[0][0]       
__________________________________________________________________________________________________
block5b_expand_conv (Conv2D)    (None, 8, 8, 672)    75264       block5a_project_bn[0][0]         
__________________________________________________________________________________________________
block5b_expand_bn (BatchNormali (None, 8, 8, 672)    2688        block5b_expand_conv[0][0]        
__________________________________________________________________________________________________
block5b_expand_activation (Acti (None, 8, 8, 672)    0           block5b_expand_bn[0][0]          
__________________________________________________________________________________________________
block5b_dwconv (DepthwiseConv2D (None, 8, 8, 672)    16800       block5b_expand_activation[0][0]  
__________________________________________________________________________________________________
block5b_bn (BatchNormalization) (None, 8, 8, 672)    2688        block5b_dwconv[0][0]             
__________________________________________________________________________________________________
block5b_activation (Activation) (None, 8, 8, 672)    0           block5b_bn[0][0]                 
__________________________________________________________________________________________________
block5b_se_squeeze (GlobalAvera (None, 672)          0           block5b_activation[0][0]         
__________________________________________________________________________________________________
block5b_se_reshape (Reshape)    (None, 1, 1, 672)    0           block5b_se_squeeze[0][0]         
__________________________________________________________________________________________________
block5b_se_reduce (Conv2D)      (None, 1, 1, 28)     18844       block5b_se_reshape[0][0]         
__________________________________________________________________________________________________
block5b_se_expand (Conv2D)      (None, 1, 1, 672)    19488       block5b_se_reduce[0][0]          
__________________________________________________________________________________________________
block5b_se_excite (Multiply)    (None, 8, 8, 672)    0           block5b_activation[0][0]         
                                                                 block5b_se_expand[0][0]          
__________________________________________________________________________________________________
block5b_project_conv (Conv2D)   (None, 8, 8, 112)    75264       block5b_se_excite[0][0]          
__________________________________________________________________________________________________
block5b_project_bn (BatchNormal (None, 8, 8, 112)    448         block5b_project_conv[0][0]       
__________________________________________________________________________________________________
block5b_drop (Dropout)          (None, 8, 8, 112)    0           block5b_project_bn[0][0]         
__________________________________________________________________________________________________
block5b_add (Add)               (None, 8, 8, 112)    0           block5b_drop[0][0]               
                                                                 block5a_project_bn[0][0]         
__________________________________________________________________________________________________
block5c_expand_conv (Conv2D)    (None, 8, 8, 672)    75264       block5b_add[0][0]                
__________________________________________________________________________________________________
block5c_expand_bn (BatchNormali (None, 8, 8, 672)    2688        block5c_expand_conv[0][0]        
__________________________________________________________________________________________________
block5c_expand_activation (Acti (None, 8, 8, 672)    0           block5c_expand_bn[0][0]          
__________________________________________________________________________________________________
block5c_dwconv (DepthwiseConv2D (None, 8, 8, 672)    16800       block5c_expand_activation[0][0]  
__________________________________________________________________________________________________
block5c_bn (BatchNormalization) (None, 8, 8, 672)    2688        block5c_dwconv[0][0]             
__________________________________________________________________________________________________
block5c_activation (Activation) (None, 8, 8, 672)    0           block5c_bn[0][0]                 
__________________________________________________________________________________________________
block5c_se_squeeze (GlobalAvera (None, 672)          0           block5c_activation[0][0]         
__________________________________________________________________________________________________
block5c_se_reshape (Reshape)    (None, 1, 1, 672)    0           block5c_se_squeeze[0][0]         
__________________________________________________________________________________________________
block5c_se_reduce (Conv2D)      (None, 1, 1, 28)     18844       block5c_se_reshape[0][0]         
__________________________________________________________________________________________________
block5c_se_expand (Conv2D)      (None, 1, 1, 672)    19488       block5c_se_reduce[0][0]          
__________________________________________________________________________________________________
block5c_se_excite (Multiply)    (None, 8, 8, 672)    0           block5c_activation[0][0]         
                                                                 block5c_se_expand[0][0]          
__________________________________________________________________________________________________
block5c_project_conv (Conv2D)   (None, 8, 8, 112)    75264       block5c_se_excite[0][0]          
__________________________________________________________________________________________________
block5c_project_bn (BatchNormal (None, 8, 8, 112)    448         block5c_project_conv[0][0]       
__________________________________________________________________________________________________
block5c_drop (Dropout)          (None, 8, 8, 112)    0           block5c_project_bn[0][0]         
__________________________________________________________________________________________________
block5c_add (Add)               (None, 8, 8, 112)    0           block5c_drop[0][0]               
                                                                 block5b_add[0][0]                
__________________________________________________________________________________________________
block6a_expand_conv (Conv2D)    (None, 8, 8, 672)    75264       block5c_add[0][0]                
__________________________________________________________________________________________________
block6a_expand_bn (BatchNormali (None, 8, 8, 672)    2688        block6a_expand_conv[0][0]        
__________________________________________________________________________________________________
block6a_expand_activation (Acti (None, 8, 8, 672)    0           block6a_expand_bn[0][0]          
__________________________________________________________________________________________________
block6a_dwconv_pad (ZeroPadding (None, 11, 11, 672)  0           block6a_expand_activation[0][0]  
__________________________________________________________________________________________________
block6a_dwconv (DepthwiseConv2D (None, 4, 4, 672)    16800       block6a_dwconv_pad[0][0]         
__________________________________________________________________________________________________
block6a_bn (BatchNormalization) (None, 4, 4, 672)    2688        block6a_dwconv[0][0]             
__________________________________________________________________________________________________
block6a_activation (Activation) (None, 4, 4, 672)    0           block6a_bn[0][0]                 
__________________________________________________________________________________________________
block6a_se_squeeze (GlobalAvera (None, 672)          0           block6a_activation[0][0]         
__________________________________________________________________________________________________
block6a_se_reshape (Reshape)    (None, 1, 1, 672)    0           block6a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block6a_se_reduce (Conv2D)      (None, 1, 1, 28)     18844       block6a_se_reshape[0][0]         
__________________________________________________________________________________________________
block6a_se_expand (Conv2D)      (None, 1, 1, 672)    19488       block6a_se_reduce[0][0]          
__________________________________________________________________________________________________
block6a_se_excite (Multiply)    (None, 4, 4, 672)    0           block6a_activation[0][0]         
                                                                 block6a_se_expand[0][0]          
__________________________________________________________________________________________________
block6a_project_conv (Conv2D)   (None, 4, 4, 192)    129024      block6a_se_excite[0][0]          
__________________________________________________________________________________________________
block6a_project_bn (BatchNormal (None, 4, 4, 192)    768         block6a_project_conv[0][0]       
__________________________________________________________________________________________________
block6b_expand_conv (Conv2D)    (None, 4, 4, 1152)   221184      block6a_project_bn[0][0]         
__________________________________________________________________________________________________
block6b_expand_bn (BatchNormali (None, 4, 4, 1152)   4608        block6b_expand_conv[0][0]        
__________________________________________________________________________________________________
block6b_expand_activation (Acti (None, 4, 4, 1152)   0           block6b_expand_bn[0][0]          
__________________________________________________________________________________________________
block6b_dwconv (DepthwiseConv2D (None, 4, 4, 1152)   28800       block6b_expand_activation[0][0]  
__________________________________________________________________________________________________
block6b_bn (BatchNormalization) (None, 4, 4, 1152)   4608        block6b_dwconv[0][0]             
__________________________________________________________________________________________________
block6b_activation (Activation) (None, 4, 4, 1152)   0           block6b_bn[0][0]                 
__________________________________________________________________________________________________
block6b_se_squeeze (GlobalAvera (None, 1152)         0           block6b_activation[0][0]         
__________________________________________________________________________________________________
block6b_se_reshape (Reshape)    (None, 1, 1, 1152)   0           block6b_se_squeeze[0][0]         
__________________________________________________________________________________________________
block6b_se_reduce (Conv2D)      (None, 1, 1, 48)     55344       block6b_se_reshape[0][0]         
__________________________________________________________________________________________________
block6b_se_expand (Conv2D)      (None, 1, 1, 1152)   56448       block6b_se_reduce[0][0]          
__________________________________________________________________________________________________
block6b_se_excite (Multiply)    (None, 4, 4, 1152)   0           block6b_activation[0][0]         
                                                                 block6b_se_expand[0][0]          
__________________________________________________________________________________________________
block6b_project_conv (Conv2D)   (None, 4, 4, 192)    221184      block6b_se_excite[0][0]          
__________________________________________________________________________________________________
block6b_project_bn (BatchNormal (None, 4, 4, 192)    768         block6b_project_conv[0][0]       
__________________________________________________________________________________________________
block6b_drop (Dropout)          (None, 4, 4, 192)    0           block6b_project_bn[0][0]         
__________________________________________________________________________________________________
block6b_add (Add)               (None, 4, 4, 192)    0           block6b_drop[0][0]               
                                                                 block6a_project_bn[0][0]         
__________________________________________________________________________________________________
block6c_expand_conv (Conv2D)    (None, 4, 4, 1152)   221184      block6b_add[0][0]                
__________________________________________________________________________________________________
block6c_expand_bn (BatchNormali (None, 4, 4, 1152)   4608        block6c_expand_conv[0][0]        
__________________________________________________________________________________________________
block6c_expand_activation (Acti (None, 4, 4, 1152)   0           block6c_expand_bn[0][0]          
__________________________________________________________________________________________________
block6c_dwconv (DepthwiseConv2D (None, 4, 4, 1152)   28800       block6c_expand_activation[0][0]  
__________________________________________________________________________________________________
block6c_bn (BatchNormalization) (None, 4, 4, 1152)   4608        block6c_dwconv[0][0]             
__________________________________________________________________________________________________
block6c_activation (Activation) (None, 4, 4, 1152)   0           block6c_bn[0][0]                 
__________________________________________________________________________________________________
block6c_se_squeeze (GlobalAvera (None, 1152)         0           block6c_activation[0][0]         
__________________________________________________________________________________________________
block6c_se_reshape (Reshape)    (None, 1, 1, 1152)   0           block6c_se_squeeze[0][0]         
__________________________________________________________________________________________________
block6c_se_reduce (Conv2D)      (None, 1, 1, 48)     55344       block6c_se_reshape[0][0]         
__________________________________________________________________________________________________
block6c_se_expand (Conv2D)      (None, 1, 1, 1152)   56448       block6c_se_reduce[0][0]          
__________________________________________________________________________________________________
block6c_se_excite (Multiply)    (None, 4, 4, 1152)   0           block6c_activation[0][0]         
                                                                 block6c_se_expand[0][0]          
__________________________________________________________________________________________________
block6c_project_conv (Conv2D)   (None, 4, 4, 192)    221184      block6c_se_excite[0][0]          
__________________________________________________________________________________________________
block6c_project_bn (BatchNormal (None, 4, 4, 192)    768         block6c_project_conv[0][0]       
__________________________________________________________________________________________________
block6c_drop (Dropout)          (None, 4, 4, 192)    0           block6c_project_bn[0][0]         
__________________________________________________________________________________________________
block6c_add (Add)               (None, 4, 4, 192)    0           block6c_drop[0][0]               
                                                                 block6b_add[0][0]                
__________________________________________________________________________________________________
block6d_expand_conv (Conv2D)    (None, 4, 4, 1152)   221184      block6c_add[0][0]                
__________________________________________________________________________________________________
block6d_expand_bn (BatchNormali (None, 4, 4, 1152)   4608        block6d_expand_conv[0][0]        
__________________________________________________________________________________________________
block6d_expand_activation (Acti (None, 4, 4, 1152)   0           block6d_expand_bn[0][0]          
__________________________________________________________________________________________________
block6d_dwconv (DepthwiseConv2D (None, 4, 4, 1152)   28800       block6d_expand_activation[0][0]  
__________________________________________________________________________________________________
block6d_bn (BatchNormalization) (None, 4, 4, 1152)   4608        block6d_dwconv[0][0]             
__________________________________________________________________________________________________
block6d_activation (Activation) (None, 4, 4, 1152)   0           block6d_bn[0][0]                 
__________________________________________________________________________________________________
block6d_se_squeeze (GlobalAvera (None, 1152)         0           block6d_activation[0][0]         
__________________________________________________________________________________________________
block6d_se_reshape (Reshape)    (None, 1, 1, 1152)   0           block6d_se_squeeze[0][0]         
__________________________________________________________________________________________________
block6d_se_reduce (Conv2D)      (None, 1, 1, 48)     55344       block6d_se_reshape[0][0]         
__________________________________________________________________________________________________
block6d_se_expand (Conv2D)      (None, 1, 1, 1152)   56448       block6d_se_reduce[0][0]          
__________________________________________________________________________________________________
block6d_se_excite (Multiply)    (None, 4, 4, 1152)   0           block6d_activation[0][0]         
                                                                 block6d_se_expand[0][0]          
__________________________________________________________________________________________________
block6d_project_conv (Conv2D)   (None, 4, 4, 192)    221184      block6d_se_excite[0][0]          
__________________________________________________________________________________________________
block6d_project_bn (BatchNormal (None, 4, 4, 192)    768         block6d_project_conv[0][0]       
__________________________________________________________________________________________________
block6d_drop (Dropout)          (None, 4, 4, 192)    0           block6d_project_bn[0][0]         
__________________________________________________________________________________________________
block6d_add (Add)               (None, 4, 4, 192)    0           block6d_drop[0][0]               
                                                                 block6c_add[0][0]                
__________________________________________________________________________________________________
block7a_expand_conv (Conv2D)    (None, 4, 4, 1152)   221184      block6d_add[0][0]                
__________________________________________________________________________________________________
block7a_expand_bn (BatchNormali (None, 4, 4, 1152)   4608        block7a_expand_conv[0][0]        
__________________________________________________________________________________________________
block7a_expand_activation (Acti (None, 4, 4, 1152)   0           block7a_expand_bn[0][0]          
__________________________________________________________________________________________________
block7a_dwconv (DepthwiseConv2D (None, 4, 4, 1152)   10368       block7a_expand_activation[0][0]  
__________________________________________________________________________________________________
block7a_bn (BatchNormalization) (None, 4, 4, 1152)   4608        block7a_dwconv[0][0]             
__________________________________________________________________________________________________
block7a_activation (Activation) (None, 4, 4, 1152)   0           block7a_bn[0][0]                 
__________________________________________________________________________________________________
block7a_se_squeeze (GlobalAvera (None, 1152)         0           block7a_activation[0][0]         
__________________________________________________________________________________________________
block7a_se_reshape (Reshape)    (None, 1, 1, 1152)   0           block7a_se_squeeze[0][0]         
__________________________________________________________________________________________________
block7a_se_reduce (Conv2D)      (None, 1, 1, 48)     55344       block7a_se_reshape[0][0]         
__________________________________________________________________________________________________
block7a_se_expand (Conv2D)      (None, 1, 1, 1152)   56448       block7a_se_reduce[0][0]          
__________________________________________________________________________________________________
block7a_se_excite (Multiply)    (None, 4, 4, 1152)   0           block7a_activation[0][0]         
                                                                 block7a_se_expand[0][0]          
__________________________________________________________________________________________________
block7a_project_conv (Conv2D)   (None, 4, 4, 320)    368640      block7a_se_excite[0][0]          
__________________________________________________________________________________________________
block7a_project_bn (BatchNormal (None, 4, 4, 320)    1280        block7a_project_conv[0][0]       
__________________________________________________________________________________________________/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/optimizer_v2/optimizer_v2.py:375: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  "The `lr` argument is deprecated, use `learning_rate` instead.")
/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/utils/generic_utils.py:497: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  category=CustomMaskWarning)

top_conv (Conv2D)               (None, 4, 4, 1280)   409600      block7a_project_bn[0][0]         
__________________________________________________________________________________________________
top_bn (BatchNormalization)     (None, 4, 4, 1280)   5120        top_conv[0][0]                   
__________________________________________________________________________________________________
top_activation (Activation)     (None, 4, 4, 1280)   0           top_bn[0][0]                     
__________________________________________________________________________________________________
pool5 (GlobalAveragePooling2D)  (None, 1280)         0           top_activation[0][0]             
__________________________________________________________________________________________________
Compound (Dense)                (None, 570)          730170      pool5[0][0]                      
==================================================================================================
Total params: 4,780,321
Trainable params: 4,738,294
Non-trainable params: 42,027
__________________________________________________________________________________________________
COMET INFO: Experiment is live on comet.ml https://www.comet.ml/michaelbornholdt/deepprofiler-lincs/09d83f44f08b458cbbadc45b970f5903

COMET WARNING: truncated string; too long: '{"checkpoints": "/local_group_storage/broad_data/michael/training/outputs/806_train/checkpoint/", "compressed_images": "/local_group_storage/broad_data/michael/training/outputs/compressed/images/", "config": "/local_group_storage/broad_data/michael/training/inputs/config/", "features": "/local_group_storage/broad_data/michael/training/outputs/806_train/features/", "images": "/local_group_storage/broad_data/michael/training/inputs/images/", "index": "/local_group_storage/broad_data/michael/training/inputs/metadata/top20_moa.csv", "intensities": "/local_group_storage/broad_data/michael/training/outputs/intensities/", "locations": "/local_group_storage/broad_data/michael/training/inputs/locations/", "logs": "/local_group_storage/broad_data/michael/training/outputs/806_train/logs/", "metadata": "/local_group_storage/broad_data/michael/training/inputs/metadata/", "results": "/local_group_storage/broad_data/michael/training/outputs/806_train/", "root": "/local_group_storage/broad_data/michael/training", "single_cell_sample": "/local_group_storage/broad_data/michael/training/outputs/top20/", "summaries": "/local_group_storage/broad_data/michael/training/outputs/806_train/summaries/"}'...
2021-08-06 21:09:49.804964: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-08-06 21:09:49.813756: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcuda.so.1
2021-08-06 21:09:49.845707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1733] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: A100-SXM4-40GB computeCapability: 8.0
coreClock: 1.41GHz coreCount: 108 deviceMemorySize: 39.59GiB deviceMemoryBandwidth: 1.41TiB/s
2021-08-06 21:09:49.845769: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-08-06 21:09:49.849985: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-08-06 21:09:49.850052: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-08-06 21:09:49.851553: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcufft.so.10
2021-08-06 21:09:49.851870: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcurand.so.10
2021-08-06 21:09:49.853047: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusolver.so.11
2021-08-06 21:09:49.854123: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcusparse.so.11
2021-08-06 21:09:49.854365: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-08-06 21:09:49.858308: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1871] Adding visible gpu devices: 0
2021-08-06 21:09:49.858355: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
2021-08-06 21:09:50.592933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1258] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-08-06 21:09:50.592987: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1264]      0 
2021-08-06 21:09:50.592996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1277] 0:   N 
2021-08-06 21:09:50.597425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1418] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 32874 MB memory) -> physical GPU (device: 0, name: A100-SXM4-40GB, pci bus id: 0000:01:00.0, compute capability: 8.0)
2021-08-06 21:09:50,605 - WARNING - From /DeepProfiler/deepprofiler/learning/model.py:133: The name tf.keras.backend.set_session is deprecated. Please use tf.compat.v1.keras.backend.set_session instead.

2021-08-06 21:09:51.019756: I tensorflow/core/platform/profile_utils/cpu_utils.cc:114] CPU Frequency: 3200140000 Hz
Validation data loaded : 600 records of 600
Downloading data from https://storage.googleapis.com/keras-applications/efficientnetb0_notop.h5
16711680/16705208 [==============================] - 0s 0us/step
Network initialized with pretrained ImageNet weights
2021-08-06 21:12:28,173 - WARNING - `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
/usr/local/lib/python3.6/dist-packages/tensorflow/python/keras/engine/training_v1.py:1246: UserWarning: `model.fit_generator` is deprecated and will be removed in a future version. Please use `Model.fit`, which supports generators.
  warnings.warn('`model.fit_generator` is deprecated and '
 || => Total single cells: 5060536
 || => Median # of images per class: 44
 || => Number of classes: 570
 || => Median # of cells per image: 219
 || => Approx. cells per epoch (with balanced sampling): 5492520
 || => Images sampled per worker: 16
 || => Cache data coverage: 0%
 || => Steps per epoch: 85820

Epoch 00001: LearningRateScheduler reducing learning rate to 0.001.
Epoch 1/10
2021-08-06 21:12:38.923452: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudnn.so.8
2021-08-06 21:12:39.767286: I tensorflow/stream_executor/cuda/cuda_dnn.cc:359] Loaded cuDNN version 8100
2021-08-06 21:12:40.636535: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublas.so.11
2021-08-06 21:12:41.558536: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcublasLt.so.11
2021-08-06 21:12:42.570870: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
85820/85820 [==============================] - 23518s 274ms/step - batch: 42909.5000 - size: 64.0000 - loss: 3.5673 - acc: 0.2571 - top_10: 0.6456 - val_loss: 2.5462 - val_acc: 0.4172 - val_top_10: 0.8412 - lr: 0.0010

Epoch 00002: LearningRateScheduler reducing learning rate to 0.00125.
Epoch 2/10
85820/85820 [==============================] - 24248s 283ms/step - batch: 42909.5000 - size: 64.0000 - loss: 2.0365 - acc: 0.5079 - top_10: 0.9006 - val_loss: 3.8200 - val_acc: 0.2791 - val_top_10: 0.6940 - lr: 0.0012

Epoch 00003: LearningRateScheduler reducing learning rate to 0.0016666666666666668.
Epoch 3/10
85820/85820 [==============================] - 23908s 279ms/step - batch: 42909.5000 - size: 64.0000 - loss: 1.6226 - acc: 0.6054 - top_10: 0.9356 - val_loss: 2.8334 - val_acc: 0.4201 - val_top_10: 0.8351 - lr: 0.0017

Epoch 00004: LearningRateScheduler reducing learning rate to 0.0025.
Epoch 4/10
85820/85820 [==============================] - 24138s 281ms/step - batch: 42909.5000 - size: 64.0000 - loss: 1.3971 - acc: 0.6642 - top_10: 0.9490 - val_loss: 1.9039 - val_acc: 0.5889 - val_top_10: 0.9302 - lr: 0.0025

Epoch 00005: LearningRateScheduler reducing learning rate to 0.005.
Epoch 5/10
85820/85820 [==============================] - 16599s 193ms/step - batch: 42909.5000 - size: 64.0000 - loss: 1.2954 - acc: 0.6932 - top_10: 0.9539 - val_loss: 2.7624 - val_acc: 0.4668 - val_top_10: 0.8671 - lr: 0.0050

Epoch 00006: LearningRateScheduler reducing learning rate to 0.0025.
Epoch 6/10
85820/85820 [==============================] - 12991s 151ms/step - batch: 42909.5000 - size: 64.0000 - loss: 1.0001 - acc: 0.7783 - top_10: 0.9641 - val_loss: 1.9958 - val_acc: 0.6085 - val_top_10: 0.9344 - lr: 0.0025

Epoch 00007: LearningRateScheduler reducing learning rate to 0.0017274575140626316.
Epoch 7/10
85820/85820 [==============================] - 13353s 156ms/step - batch: 42909.5000 - size: 64.0000 - loss: 0.8835 - acc: 0.8115 - top_10: 0.9670 - val_loss: 1.9607 - val_acc: 0.6137 - val_top_10: 0.9359 - lr: 0.0017

Epoch 00008: LearningRateScheduler reducing learning rate to 0.0010305368692688174.
Epoch 8/10
85820/85820 [==============================] - 13832s 161ms/step - batch: 42909.5000 - size: 64.0000 - loss: 0.8004 - acc: 0.8355 - top_10: 0.9688 - val_loss: 1.5838 - val_acc: 0.6931 - val_top_10: 0.9584 - lr: 0.0010

Epoch 00009: LearningRateScheduler reducing learning rate to 0.00047745751406263163.
Epoch 9/10
85820/85820 [==============================] - 13544s 158ms/step - batch: 42909.5000 - size: 64.0000 - loss: 0.7505 - acc: 0.8505 - top_10: 0.9697 - val_loss: 1.4794 - val_acc: 0.7126 - val_top_10: 0.9637 - lr: 4.7746e-04

Epoch 00010: LearningRateScheduler reducing learning rate to 0.00012235870926211617.
Epoch 10/10
85820/85820 [==============================] - 13939s 162ms/step - batch: 42909.5000 - size: 64.0000 - loss: 0.7196 - acc: 0.8601 - top_10: 0.9703 - val_loss: 1.4317 - val_acc: 0.7293 - val_top_10: 0.9663 - lr: 1.2236e-04
Complete! Closing session. All set.
COMET INFO: ---------------------------
COMET INFO: Comet.ml Experiment Summary
COMET INFO: ---------------------------
COMET INFO:   Data:
COMET INFO:     display_summary_level : 1
COMET INFO:     url                   : https://www.comet.ml/michaelbornholdt/deepprofiler-lincs/09d83f44f08b458cbbadc45b970f5903
COMET INFO:   Metrics:
COMET INFO:     cache_usage       : 10
COMET INFO:     worker_efficiency : 10
COMET INFO:   Others:
COMET INFO:     Name            : 806_train
COMET INFO:     batch_size      : 64
COMET INFO:     conv_blocks     : 1
COMET INFO:     dataset         : {"images": {"bits": 8, "channels": ["DNA", "RNA", "ER", "AGP", "Mito"], "file_format": "png", "height": 1080, "width": 1080}, "locations": {"area_coverage": 0.75, "box_size": 128, "mask_objects": false, "mode": "single_cells"}, "metadata": {"control_value": "DMSO", "label_field": "Compound"}}
COMET INFO:     experiment_name : 806_train
COMET INFO:     feature_dim     : 256
COMET INFO:     learning_rate   : 0.005
COMET INFO:     paths           : {"checkpoints": "/local_group_storage/broad_data/michael/training/outputs/806_train/checkpoint/", "compressed_images": "/local_group_storage/broad_data/michael/training/outputs/compressed/images/", "config": "/local_group_storage/broad_data/michael/training/inputs/config/", "features": "/local_group_storage/broad_data/michael/training/outputs/806_train/features/", "images": "/local_group_storage/broad_data/michael/training/inputs/images/", "index": "/local_group_storage/broad_data/michael/training/inputs/metadata/top20_moa.csv", "intensities": "/local_group_storage/broad_data/michael/training/outputs/intensities/", "locations": "/local_group_storage/broad_data/michael/training/inputs/locations/", "logs": "/local_group_storage/broad_data/michael/training/outputs/806_train/logs/", "metadata": "/local_group_storage/broad_data/michael/training/inputs/metadata/", "results": "/local_group_storage/broad_data/michael/training/outputs/806_train/", "root": "/local_group_storage/broad [truncated]
COMET INFO:     pooling         : avg
COMET INFO:     prepare         : {"compression": {"implement": false, "scaling_factor": 1.0}, "illumination_correction": {"down_scale_factor": 4, "median_filter_size": 24}}
COMET INFO:     profile         : {"batch_size": 8, "checkpoint": "efficientnetb0_notop.h5", "feature_layer": "avg_pool", "use_pretrained_input_size": 224}
COMET INFO:     train           : {"comet_ml": {"api_key": "*********REDACTED*********", "project_name": "deepprofiler-lincs"}, "model": {"crop_generator": "sampled_crop_generator", "epochs": 10, "initialization": "ImageNet", "lr_schedule": "cosine", "metrics": ["accuracy", "top_k"], "name": "efficientnet", "params": {"batch_size": 64, "conv_blocks": 0, "feature_dim": 256, "learning_rate": 0.005, "pooling": "avg"}}, "partition": {"split_field": "Split", "targets": ["Compound"], "training_values": ["Training"], "validation_values": ["Test"]}, "sampling": {"cache_size": 10000, "factor": 1, "workers": 4}, "validation": {"batch_size": 64, "frame": "val", "frequency": 1, "sample_first_crops": true, "top_k": 10}}
COMET INFO:   Uploads:
COMET INFO:     environment details : 1
COMET INFO:     filename            : 1
COMET INFO:     installed packages  : 1
COMET INFO:     os packages         : 1
COMET INFO:     source_code         : 1 (8 KB)
COMET INFO: ---------------------------
COMET INFO: Uploading metrics, params, and assets to Comet before program termination (may take several seconds)
COMET INFO: The Python SDK has 3600 seconds to finish before aborting...
-------------
finished training 14255338
